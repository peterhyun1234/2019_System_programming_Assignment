		JSUB	SCAN
		JSUB	COMP
		JSUB	PRINT
		JSUB	END


SCAN	LDS		#3
		LDX		#0
		LDF		#0
		LDT		#24
SLOOP	TD		STDIN
		JEQ		SLOOP
		RD		STDIN
		COMP	#32
		JEQ		STORE
		SUB		#48
		MULF	#10
		ADDR	A, F
		
		
AFSTR	COMP	#21
		JEQ		COMP
		J		SLOOP
		RSUB

STORE	FIX
		STA		INPUT, X
		ADDR	S, X
		STX		NUM
		LDA		THREE
		STA		TARG
		COMPR	X, T
		JGT		ERR
		LDF 	#0
		J		AFSTR



COMP	LDS		#3
		LDA		TARG
		STA		TMP
		STA		TAR

CLOOP	LDA		TMP
		COMP	#0
		JEQ		AFTOC
		JLT		AFTOC
		SUB		THREE
		STA		TMP
		LDX		TAR
		LDA		INPUT, X
		LDX		TMP
		COMP	INPUT, X
		JEQ		AFTOC
		JGT		AFTOC
		JLT		SWAP
		J		CLOOP


AFTOC	J		PRINT
AFPRT	LDA		TARG
		ADD		THREE
		STA		TARG
		LDA		NUM
		COMP	TARG
		JEQ		END
		JLT		END
		J		COMP
		RSUB

SWAP	LDX		TMP
		LDA		INPUT, X
		STA		TMVL
		LDX		TAR
		LDA		INPUT, X
		LDX		TMP
		STA		INPUT, X
		LDA		TMVL
		LDX		TAR
		STA		INPUT, X
		LDA		TAR
		SUB		THREE
		STA		TAR
		J		CLOOP	

PRINT	LDS		#3
		LDX		#0
		LDT		NUM
PLOOP	TD		STDOUT
		JEQ		PLOOP
		LDA		INPUT,X
		STA		PNUM
		COMP	#4095
		JGT		ERR
		JEQ		PTHS
		JLT		PTHS

AFTPN	LDA		#32
		WD		STDOUT
		ADDR	S, X
		COMPR	X, T
		JLT		PLOOP
		LDA		#14
		WD		STDOUT
		LDA		#10
		WD		STDOUT
		J		AFPRT

PT		LDA		PNUM
		ADD		#48
		WD		STDOUT
		SUB		#48
		J		AFTPN

PTEN	LDA		PNUM
		COMP	#9
		JEQ		PT
		JLT		PT
		STA		PNUM
		DIV		#10
		ADD		#48
		WD		STDOUT
		SUB		#48
		MUL		#10
		STA		SNUM
		LDA		PNUM
		SUB		SNUM
		STA		PNUM
		J		PTEN


PHUN	LDA		PNUM
		COMP	#99
		JEQ		PTEN
		JLT		PTEN
		STA		PNUM
		DIV		#100
		ADD		#48
		WD		STDOUT
		SUB		#48
		MUL		#100
		STA		SNUM
		LDA		PNUM
		SUB		SNUM
		STA		PNUM
		J		PHUN


PTHS	LDA		PNUM		
		COMP	#999
		JEQ		PHUN
		JLT		PHUN
		STA		PNUM
		DIV		#1000
		ADD		#48
		WD		STDOUT
		SUB		#48
		MUL		#1000
		STA		SNUM
		LDA		PNUM
		SUB		SNUM
		STA		PNUM
		J		PTHS

ERR		LDA		ERRT
		WD		STDOUT
		J		END

END		J		END

		
STDIN	BYTE	0
STDOUT	BYTE	1
TMVL	RESW	1
TARG	RESW	1
TMP		RESW	1
NUM		RESW	1
TAR		RESW	1
PNUM	RESW	1
SNUM	RESW	1
THREE	WORD	3
INPUT	RESW	8
ERRT	BYTE	C'INPUT ERROR'
EOF		BYTE	C'EOF'
